## 网页链路分析

链路分析旨在通过前段埋点数据分析出用户访问链路的过程。

原始数据为json格式，

下面展示使用不同框架在计算过程中的代码量，请注意，其本质区别还是计算性能和实时要求的区别。

原始数据是json格式进行存放的，在试验阶段使用下述简化的数据。

```yaml
user_id,timestamp,page
1,2024-05-01T10:00:00,home
1,2024-05-01T10:01:00,about
1,2024-05-01T10:02:00,contact
1,2024-05-01T10:03:00,products
2,2024-05-01T10:00:00,home
2,2024-05-01T10:01:00,products
2,2024-05-01T10:02:00,product_details
3,2024-05-01T10:00:00,home
3,2024-05-01T10:01:00,about
3,2024-05-01T10:03:00,contact
4,2024-05-01T10:00:00,home
4,2024-05-01T10:02:00,about
4,2024-05-01T10:04:00,products
4,2024-05-01T10:06:00,product_details
5,2024-05-01T10:00:00,home
5,2024-05-01T10:01:00,contact
5,2024-05-01T10:02:00,products
5,2024-05-01T10:04:00,product_details
6,2024-05-01T10:00:00,home
6,2024-05-01T10:02:00,about
6,2024-05-01T10:04:00,contact
7,2024-05-01T10:00:00,home
7,2024-05-01T10:03:00,products
7,2024-05-01T10:04:00,product_details
8,2024-05-01T10:00:00,home
8,2024-05-01T10:02:00,about
8,2024-05-01T10:04:00,contact
8,2024-05-01T10:06:00,products
9,2024-05-01T10:00:00,home
9,2024-05-01T10:01:00,products
9,2024-05-01T10:03:00,product_details
10,2024-05-01T10:00:00,home
10,2024-05-01T10:01:00,about
10,2024-05-01T10:02:00,products
10,2024-05-01T10:03:00,product_details
```

### 计算用户访问链路的频率高低

|                      | Spark | Flink  |
| -------------------- | ----- | ------ |
| 计算用户路径时间     | 85ms  | 1689ms |
| 统计完全一致链路时间 | 10ms  | 42ms   |

